#!/usr/bin/ruby
require '../lib/stellar_utility/stellar_utility.rb'
Utils = Stellar_utility::Utils.new("./livenet_read_ticker.cfg")
#require 'stellar-base'
#require 'json'
#bundler exec ruby ./try_parse_txhistory.rb


txid = "349f49695c9e44dc7e460446409b9f2002c4179931cef0290bd1b7cd5937cbed"

ledgerseq = 7357118

txbody = "AAAAAGkVb0Fgv3dHBJe0casfrMHWO+nARn+qbF8I9vA10xEYAAAD6ABbD7UAAAMMAAAAAAAAAAAAAAAKAAAAAAAAAAMAAAABbUJUQwAAAABpigEf7e9h5IpePeEXCoPJPqY8IRt8hpneL5+OXfZ45QAAAAAAAAAAAvrwgFGdLj8AOGDzAAAAAAAABqIAAAABAAAAAGkVb0Fgv3dHBJe0casfrMHWO+nARn+qbF8I9vA10xEYAAAAAwAAAAAAAAABbUJUQwAAAABpigEf7e9h5IpePeEXCoPJPqY8IRt8hpneL5+OXfZ45QAAAARQbvY2ABdPByAdrUcAAAAAAAAGowAAAAEAAAAAaRVvQWC/d0cEl7Rxqx+swdY76cBGf6psXwj28DXTERgAAAADAAAAAUZVTlQAAAAAaYoBH+3vYeSKXj3hFwqDyT6mPCEbfIaZ3i+fjl32eOUAAAABVEhCAAAAAABpigEf7e9h5IpePeEXCoPJPqY8IRt8hpneL5+OXfZ45QAAAAAF9eEAAAAAyQAAAAUAAAAAAAAGpAAAAAEAAAAAaRVvQWC/d0cEl7Rxqx+swdY76cBGf6psXwj28DXTERgAAAADAAAAAVRIQgAAAAAAaYoBH+3vYeSKXj3hFwqDyT6mPCEbfIaZ3i+fjl32eOUAAAABRlVOVAAAAABpigEf7e9h5IpePeEXCoPJPqY8IRt8hpneL5+OXfZ45QAAAADvnFUAAAAAyQAAH0AAAAAAAAAGpQAAAAEAAAAAaRVvQWC/d0cEl7Rxqx+swdY76cBGf6psXwj28DXTERgAAAADAAAAAUZVTlQAAAAAaYoBH+3vYeSKXj3hFwqDyT6mPCEbfIaZ3i+fjl32eOUAAAAAAAAAAAX14QAvbRk8ABRa3QAAAAAAAAamAAAAAQAAAABpFW9BYL93RwSXtHGrH6zB1jvpwEZ/qmxfCPbwNdMRGAAAAAMAAAAAAAAAAUZVTlQAAAAAaYoBH+3vYeSKXj3hFwqDyT6mPCEbfIaZ3i+fjl32eOUAAAAN4zxK0AAL3sgaUw4jAAAAAAAABqcAAAABAAAAAGkVb0Fgv3dHBJe0casfrMHWO+nARn+qbF8I9vA10xEYAAAAAwAAAAFUSEIAAAAAAGmKAR/t72Hkil494RcKg8k+pjwhG3yGmd4vn45d9njlAAAAAVVTRAAAAAAAaYoBH+3vYeSKXj3hFwqDyT6mPCEbfIaZ3i+fjl32eOUAAAAAyqfiAAEnHY8oNP5dAAAAAAAABqgAAAABAAAAAGkVb0Fgv3dHBJe0casfrMHWO+nARn+qbF8I9vA10xEYAAAAAwAAAAFVU0QAAAAAAGmKAR/t72Hkil494RcKg8k+pjwhG3yGmd4vn45d9njlAAAAAVRIQgAAAAAAaYoBH+3vYeSKXj3hFwqDyT6mPCEbfIaZ3i+fjl32eOUAAAAABc95Onx0p8wDiGz3AAAAAAAABqkAAAABAAAAAGkVb0Fgv3dHBJe0casfrMHWO+nARn+qbF8I9vA10xEYAAAAAwAAAAAAAAABVVNEAAAAAABpigEf7e9h5IpePeEXCoPJPqY8IRt8hpneL5+OXfZ45QAAAAlQL5AAADhzyG21JdcAAAAAAAAGqgAAAAEAAAAAaRVvQWC/d0cEl7Rxqx+swdY76cBGf6psXwj28DXTERgAAAADAAAAAVVTRAAAAAAAaYoBH+3vYeSKXj3hFwqDyT6mPCEbfIaZ3i+fjl32eOUAAAAAAAAAAATK1MAUU+WPAAn0vAAAAAAAAAarAAAAAAAAAAE10xEYAAAAQMItJvsfRsRn3D/oQ5zL7bIjQ8yiXAlDAtCGHhlIPAPafevNBnxFQLIEOa0VTBq82FnvNQkWdJUCq9dpty46mQE="

txresult = "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"

txresult = "apY6uVuyeZQJQL2jTb3HGIJDxoJIPGseqzqEqGLLozAAAAAAAAAAZAAAAAAAAAABAAAAAAAAAAMAAAAAAAAAAgAAAADgVxkeVk0FyxeNcNt/h4dd99VekltuW2I8HYmeaxsmiwAAAAAAAALlAAAAAUJUQwAAAAAAJkYcQlCx7+aCVOLsN1zOJ9MrhIZ91KVjOo8aZRslCKYAAAAAAAElwAAAAAAAAAAEqBfIAAAAAADgVxkeVk0FyxeNcNt/h4dd99VekltuW2I8HYmeaxsmiwAAAAAAAALmAAAAAUJUQwAAAAAAJkYcQlCx7+aCVOLsN1zOJ9MrhIZ91KVjOo8aZRslCKYAAAAAAACQiAAAAAAAAAACVAvkAAAAAAAAAAAAW6UVXyo2G+P03Ku0ogEBAUutpVULdV49PDYy3pT+I+oAAAAAAAAGLQAAAAAAAAABQlRDAAAAAAAmRhxCULHv5oJU4uw3XM4n0yuEhn3UpWM6jxplGyUIpgAAArOBy4QAAAAAAQAEk+AAAAAAAAAAAAAAAAA="

txmeta = "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"



#puts "txmeta: #{Utils.decode_txmeta_b64(txmeta).to_yaml}"
# now moved txresult_to_hash to stellar_utility lib
Utils.txresult_to_hash(txresult,0)
#puts "txbody: #{Utils.envelope_to_hash(txbody)}"
exit


__END__

#{"txid"=>"6a963ab95bb279940940bda34dbdc7188243c682483c6b1eab3a84a862cba330", "fee_charged"=>100, "operations"=>[{"op_id"=>1, "offers_claimed"=>[{"seller_id"=>"GDQFOGI6KZGQLSYXRVYNW74HQ5O7PVK6SJNW4W3CHQOYTHTLDMTIW3W5", "offer_id"=>741, "sold_asset_code"=>"BTC\x00", "sold_issuer"=>"GATEMHCCKCY67ZUCKTROYN24ZYT5GK4EQZ65JJLDHKHRUZI3EUEKMTCH", "amount_sold"=>75200, "bought_asset_code"=>"XLM", "amount_bought"=>2000.0}, {"seller_id"=>"GDQFOGI6KZGQLSYXRVYNW74HQ5O7PVK6SJNW4W3CHQOYTHTLDMTIW3W5", "offer_id"=>742, "sold_asset_code"=>"BTC\x00", "sold_issuer"=>"GATEMHCCKCY67ZUCKTROYN24ZYT5GK4EQZ65JJLDHKHRUZI3EUEKMTCH", "amount_sold"=>37000, "bought_asset_code"=>"XLM", "amount_bought"=>1000.0}], "seller_id"=>"GBN2KFK7FI3BXY7U3SV3JIQBAEAUXLNFKUFXKXR5HQ3DFXUU7YR6UWTZ", "offer_id"=>1581, "selling_asset_code"=>"XLM", "buying_asset_code"=>"BTC\x00", "buying_issuer"=>"GATEMHCCKCY67ZUCKTROYN24ZYT5GK4EQZ65JJLDHKHRUZI3EUEKMTCH", "amount"=>297000.0, "price_n"=>1, "price_d"=>300000, "price"=>0}]}


